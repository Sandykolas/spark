-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 35


-- !query 0
SET spark.sql.ansi.enabled=true
-- !query 0 schema
struct<key:string,value:string>
-- !query 0 output
spark.sql.ansi.enabled	true


-- !query 1
select
  '1' second,
  2  seconds,
  '1' minute,
  2  minutes,
  '1' hour,
  2  hours,
  '1' day,
  2  days,
  '1' month,
  2  months,
  '1' year,
  2  years
-- !query 1 schema
struct<0:00:01:interval,0:00:02:interval,0:01:00:interval,0:02:00:interval,1:00:00:interval,2:00:00:interval,1:interval,2:interval,0-1:interval,0-2:interval,1-0:interval,2-0:interval>
-- !query 1 output
0:00:01	0:00:02	0:01:00	0:02:00	1:00:00	2:00:00	1	2	0-1	0-2	1-0	2-0


-- !query 2
select
  interval '10-11' year to month,
  interval '10' year,
  interval '11' month
-- !query 2 schema
struct<10-11:interval,10-0:interval,0-11:interval>
-- !query 2 output
10-11	10-0	0-11


-- !query 3
select
  '10-11' year to month,
  '10' year,
  '11' month
-- !query 3 schema
struct<10-11:interval,10-0:interval,0-11:interval>
-- !query 3 output
10-11	10-0	0-11


-- !query 4
select
  interval '10 9:8:7.987654321' day to second,
  interval '10' day,
  interval '11' hour,
  interval '12' minute,
  interval '13' second,
  interval '13.123456789' second
-- !query 4 schema
struct<10 9:08:07.987654:interval,10:interval,11:00:00:interval,0:12:00:interval,0:00:13:interval,0:00:13.123456:interval>
-- !query 4 output
10 9:08:07.987654	10	11:00:00	0:12:00	0:00:13	0:00:13.123456


-- !query 5
select
  '10 9:8:7.987654321' day to second,
  '10' day,
  '11' hour,
  '12' minute,
  '13' second,
  '13.123456789' second
-- !query 5 schema
struct<10 9:08:07.987654:interval,10:interval,11:00:00:interval,0:12:00:interval,0:00:13:interval,0:00:13.123456:interval>
-- !query 5 output
10 9:08:07.987654	10	11:00:00	0:12:00	0:00:13	0:00:13.123456


-- !query 6
select map(1, interval 1 day, 2, interval 3 week)
-- !query 6 schema
struct<map(1, 1, 2, 21):map<int,interval>>
-- !query 6 output
{1:1,2:21}


-- !query 7
select map(1, 1 day, 2, 3 week)
-- !query 7 schema
struct<map(1, 1, 2, 21):map<int,interval>>
-- !query 7 output
{1:1,2:21}


-- !query 8
create temporary view interval_arithmetic as
  select CAST(dateval AS date), CAST(tsval AS timestamp) from values
    ('2012-01-01', '2012-01-01')
    as interval_arithmetic(dateval, tsval)
-- !query 8 schema
struct<>
-- !query 8 output



-- !query 9
select
  dateval,
  dateval - interval '2-2' year to month,
  dateval - interval '-2-2' year to month,
  dateval + interval '2-2' year to month,
  dateval + interval '-2-2' year to month,
  - interval '2-2' year to month + dateval,
  interval '2-2' year to month + dateval
from interval_arithmetic
-- !query 9 schema
struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - 2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - -2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + -2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- 2-2) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 2-2 AS DATE):date>
-- !query 9 output
2012-01-01	2009-11-01	2014-03-01	2014-03-01	2009-11-01	2009-11-01	2014-03-01


-- !query 10
select
  dateval,
  dateval - '2-2' year to month,
  dateval - '-2-2' year to month,
  dateval + '2-2' year to month,
  dateval + '-2-2' year to month,
  - '2-2' year to month + dateval,
  '2-2' year to month + dateval
from interval_arithmetic
-- !query 10 schema
struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - 2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - -2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + -2-2 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- 2-2) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 2-2 AS DATE):date>
-- !query 10 output
2012-01-01	2009-11-01	2014-03-01	2014-03-01	2009-11-01	2009-11-01	2014-03-01


-- !query 11
select
  tsval,
  tsval - interval '2-2' year to month,
  tsval - interval '-2-2' year to month,
  tsval + interval '2-2' year to month,
  tsval + interval '-2-2' year to month,
  - interval '2-2' year to month + tsval,
  interval '2-2' year to month + tsval
from interval_arithmetic
-- !query 11 schema
struct<tsval:timestamp,CAST(tsval - 2-2 AS TIMESTAMP):timestamp,CAST(tsval - -2-2 AS TIMESTAMP):timestamp,CAST(tsval + 2-2 AS TIMESTAMP):timestamp,CAST(tsval + -2-2 AS TIMESTAMP):timestamp,CAST(tsval + (- 2-2) AS TIMESTAMP):timestamp,CAST(tsval + 2-2 AS TIMESTAMP):timestamp>
-- !query 11 output
2012-01-01 00:00:00	2009-11-01 00:00:00	2014-03-01 00:00:00	2014-03-01 00:00:00	2009-11-01 00:00:00	2009-11-01 00:00:00	2014-03-01 00:00:00


-- !query 12
select
  tsval,
  tsval - '2-2' year to month,
  tsval - '-2-2' year to month,
  tsval + '2-2' year to month,
  tsval + '-2-2' year to month,
  - '2-2' year to month + tsval,
  '2-2' year to month + tsval
from interval_arithmetic
-- !query 12 schema
struct<tsval:timestamp,CAST(tsval - 2-2 AS TIMESTAMP):timestamp,CAST(tsval - -2-2 AS TIMESTAMP):timestamp,CAST(tsval + 2-2 AS TIMESTAMP):timestamp,CAST(tsval + -2-2 AS TIMESTAMP):timestamp,CAST(tsval + (- 2-2) AS TIMESTAMP):timestamp,CAST(tsval + 2-2 AS TIMESTAMP):timestamp>
-- !query 12 output
2012-01-01 00:00:00	2009-11-01 00:00:00	2014-03-01 00:00:00	2014-03-01 00:00:00	2009-11-01 00:00:00	2009-11-01 00:00:00	2014-03-01 00:00:00


-- !query 13
select
  interval '2-2' year to month + interval '3-3' year to month,
  interval '2-2' year to month - interval '3-3' year to month
from interval_arithmetic
-- !query 13 schema
struct<(2-2 + 3-3):interval,(2-2 - 3-3):interval>
-- !query 13 output
5-5	-1-1


-- !query 14
select
  '2-2' year to month + '3-3' year to month,
  '2-2' year to month - '3-3' year to month
from interval_arithmetic
-- !query 14 schema
struct<(2-2 + 3-3):interval,(2-2 - 3-3):interval>
-- !query 14 output
5-5	-1-1


-- !query 15
select
  dateval,
  dateval - interval '99 11:22:33.123456789' day to second,
  dateval - interval '-99 11:22:33.123456789' day to second,
  dateval + interval '99 11:22:33.123456789' day to second,
  dateval + interval '-99 11:22:33.123456789' day to second,
  -interval '99 11:22:33.123456789' day to second + dateval,
  interval '99 11:22:33.123456789' day to second + dateval
from interval_arithmetic
-- !query 15 schema
struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - 99 11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - -99 -11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 99 11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + -99 -11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- 99 11:22:33.123456) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 99 11:22:33.123456 AS DATE):date>
-- !query 15 output
2012-01-01	2011-09-23	2012-04-09	2012-04-09	2011-09-23	2011-09-23	2012-04-09


-- !query 16
select
  dateval,
  dateval - '99 11:22:33.123456789' day to second,
  dateval - '-99 11:22:33.123456789' day to second,
  dateval + '99 11:22:33.123456789' day to second,
  dateval + '-99 11:22:33.123456789' day to second,
  - '99 11:22:33.123456789' day to second + dateval,
  '99 11:22:33.123456789' day to second + dateval
from interval_arithmetic
-- !query 16 schema
struct<dateval:date,CAST(CAST(dateval AS TIMESTAMP) - 99 11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) - -99 -11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 99 11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + -99 -11:22:33.123456 AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + (- 99 11:22:33.123456) AS DATE):date,CAST(CAST(dateval AS TIMESTAMP) + 99 11:22:33.123456 AS DATE):date>
-- !query 16 output
2012-01-01	2011-09-23	2012-04-09	2012-04-09	2011-09-23	2011-09-23	2012-04-09


-- !query 17
select
  tsval,
  tsval - interval '99 11:22:33.123456789' day to second,
  tsval - interval '-99 11:22:33.123456789' day to second,
  tsval + interval '99 11:22:33.123456789' day to second,
  tsval + interval '-99 11:22:33.123456789' day to second,
  -interval '99 11:22:33.123456789' day to second + tsval,
  interval '99 11:22:33.123456789' day to second + tsval
from interval_arithmetic
-- !query 17 schema
struct<tsval:timestamp,CAST(tsval - 99 11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval - -99 -11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval + 99 11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval + -99 -11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval + (- 99 11:22:33.123456) AS TIMESTAMP):timestamp,CAST(tsval + 99 11:22:33.123456 AS TIMESTAMP):timestamp>
-- !query 17 output
2012-01-01 00:00:00	2011-09-23 12:37:26.876544	2012-04-09 11:22:33.123456	2012-04-09 11:22:33.123456	2011-09-23 12:37:26.876544	2011-09-23 12:37:26.876544	2012-04-09 11:22:33.123456


-- !query 18
select
  tsval,
  tsval - '99 11:22:33.123456789' day to second,
  tsval - '-99 11:22:33.123456789' day to second,
  tsval + '99 11:22:33.123456789' day to second,
  tsval + '-99 11:22:33.123456789' day to second,
  - '99 11:22:33.123456789' day to second + tsval,
  '99 11:22:33.123456789' day to second + tsval
from interval_arithmetic
-- !query 18 schema
struct<tsval:timestamp,CAST(tsval - 99 11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval - -99 -11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval + 99 11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval + -99 -11:22:33.123456 AS TIMESTAMP):timestamp,CAST(tsval + (- 99 11:22:33.123456) AS TIMESTAMP):timestamp,CAST(tsval + 99 11:22:33.123456 AS TIMESTAMP):timestamp>
-- !query 18 output
2012-01-01 00:00:00	2011-09-23 12:37:26.876544	2012-04-09 11:22:33.123456	2012-04-09 11:22:33.123456	2011-09-23 12:37:26.876544	2011-09-23 12:37:26.876544	2012-04-09 11:22:33.123456


-- !query 19
select
  interval '99 11:22:33.123456789' day to second + interval '10 9:8:7.123456789' day to second,
  interval '99 11:22:33.123456789' day to second - interval '10 9:8:7.123456789' day to second
from interval_arithmetic
-- !query 19 schema
struct<(99 11:22:33.123456 + 10 9:08:07.123456):interval,(99 11:22:33.123456 - 10 9:08:07.123456):interval>
-- !query 19 output
109 20:30:40.246912	89 2:14:26


-- !query 20
select
  '99 11:22:33.123456789' day to second + '10 9:8:7.123456789' day to second,
  '99 11:22:33.123456789' day to second - '10 9:8:7.123456789' day to second
from interval_arithmetic
-- !query 20 schema
struct<(99 11:22:33.123456 + 10 9:08:07.123456):interval,(99 11:22:33.123456 - 10 9:08:07.123456):interval>
-- !query 20 output
109 20:30:40.246912	89 2:14:26


-- !query 21
select 30 day
-- !query 21 schema
struct<30:interval>
-- !query 21 output
30


-- !query 22
select 30 day day
-- !query 22 schema
struct<>
-- !query 22 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 14)

== SQL ==
select 30 day day
--------------^^^


-- !query 23
select 30 day day day
-- !query 23 schema
struct<>
-- !query 23 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 14)

== SQL ==
select 30 day day day
--------------^^^


-- !query 24
select date '2012-01-01' - 30 day
-- !query 24 schema
struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) - 30 AS DATE):date>
-- !query 24 output
2011-12-02


-- !query 25
select date '2012-01-01' - 30 day day
-- !query 25 schema
struct<>
-- !query 25 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 34)

== SQL ==
select date '2012-01-01' - 30 day day
----------------------------------^^^


-- !query 26
select date '2012-01-01' - 30 day day day
-- !query 26 schema
struct<>
-- !query 26 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 34)

== SQL ==
select date '2012-01-01' - 30 day day day
----------------------------------^^^


-- !query 27
select date '2012-01-01' + '-30' day
-- !query 27 schema
struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) + -30 AS DATE):date>
-- !query 27 output
2011-12-02


-- !query 28
select date '2012-01-01' + interval '-30' day
-- !query 28 schema
struct<CAST(CAST(DATE '2012-01-01' AS TIMESTAMP) + -30 AS DATE):date>
-- !query 28 output
2011-12-02


-- !query 29
select date '2012-01-01' + interval (-30) day
-- !query 29 schema
struct<>
-- !query 29 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 42)

== SQL ==
select date '2012-01-01' + interval (-30) day
------------------------------------------^^^


-- !query 30
select date '2012-01-01' + (-30) day
-- !query 30 schema
struct<>
-- !query 30 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 33)

== SQL ==
select date '2012-01-01' + (-30) day
---------------------------------^^^


-- !query 31
create temporary view t as select * from values (1), (2) as t(a)
-- !query 31 schema
struct<>
-- !query 31 output



-- !query 32
select date '2012-01-01' + interval (a + 1) day from t
-- !query 32 schema
struct<>
-- !query 32 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 44)

== SQL ==
select date '2012-01-01' + interval (a + 1) day from t
--------------------------------------------^^^


-- !query 33
select date '2012-01-01' + (a + 1) day from t
-- !query 33 schema
struct<>
-- !query 33 output
org.apache.spark.sql.catalyst.parser.ParseException

no viable alternative at input 'day'(line 1, pos 35)

== SQL ==
select date '2012-01-01' + (a + 1) day from t
-----------------------------------^^^


-- !query 34
SET spark.sql.ansi.enabled=false
-- !query 34 schema
struct<key:string,value:string>
-- !query 34 output
spark.sql.ansi.enabled	false
