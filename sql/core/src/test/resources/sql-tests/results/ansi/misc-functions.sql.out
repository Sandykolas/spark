-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 22


-- !query
select typeof(null)
-- !query schema
struct<typeof(NULL):string>
-- !query output
null


-- !query
select typeof(true)
-- !query schema
struct<typeof(true):string>
-- !query output
boolean


-- !query
select typeof(1Y), typeof(1S), typeof(1), typeof(1L)
-- !query schema
struct<typeof(1):string,typeof(1):string,typeof(1):string,typeof(1):string>
-- !query output
tinyint	smallint	int	bigint


-- !query
select typeof(cast(1.0 as float)), typeof(1.0D), typeof(1.2)
-- !query schema
struct<typeof(CAST(1.0 AS FLOAT)):string,typeof(1.0):string,typeof(1.2):string>
-- !query output
float	double	decimal(2,1)


-- !query
select typeof(date '1986-05-23'),  typeof(timestamp '1986-05-23'), typeof(interval '23 days')
-- !query schema
struct<typeof(DATE '1986-05-23'):string,typeof(TIMESTAMP '1986-05-23 00:00:00'):string,typeof(INTERVAL '23 days'):string>
-- !query output
date	timestamp	interval


-- !query
select typeof(x'ABCD'), typeof('SPARK')
-- !query schema
struct<typeof(X'ABCD'):string,typeof(SPARK):string>
-- !query output
binary	string


-- !query
select typeof(array(1, 2)), typeof(map(1, 2)), typeof(named_struct('a', 1, 'b', 'spark'))
-- !query schema
struct<typeof(array(1, 2)):string,typeof(map(1, 2)):string,typeof(named_struct(a, 1, b, spark)):string>
-- !query output
array<int>	map<int,int>	struct<a:int,b:string>


-- !query
select try(null) as try, null as notry
-- !query schema
struct<try:null,notry:null>
-- !query output
NULL	NULL


-- !query
select interval 1 day / 0 as notry
-- !query schema
struct<>
-- !query output
java.lang.ArithmeticException
divide by zero


-- !query
select try(interval 1 day / 0) as try
-- !query schema
struct<try:interval>
-- !query output
NULL


-- !query
select cast('1-1' as double) as notry
-- !query schema
struct<>
-- !query output
java.lang.NumberFormatException
invalid input syntax for type numeric: 1-1


-- !query
select try(cast('1-1' as double)) as try
-- !query schema
struct<try:double>
-- !query output
NULL


-- !query
select cast(128 as tinyint) as notry
-- !query schema
struct<>
-- !query output
java.lang.ArithmeticException
Casting 128 to byte causes overflow


-- !query
select try(cast(128 as tinyint)) as try
-- !query schema
struct<try:tinyint>
-- !query output
NULL


-- !query
select encode('abc', 'utf-99') as notry
-- !query schema
struct<>
-- !query output
java.io.UnsupportedEncodingException
utf-99


-- !query
select try(encode('abc', 'utf-99')) as try
-- !query schema
struct<try:binary>
-- !query output
NULL


-- !query
select date_format(timestamp '2019-10-06', 'yyyy-MM-dd uucc') as notry
-- !query schema
struct<>
-- !query output
java.lang.IllegalArgumentException
Illegal pattern character: c


-- !query
select try(date_format(timestamp '2019-10-06', 'yyyy-MM-dd uucc')) as try
-- !query schema
struct<try:string>
-- !query output
NULL


-- !query
select regexp_extract('1a 2b 14m', '\\d+', 1) as notry
-- !query schema
struct<>
-- !query output
java.lang.IllegalArgumentException
Regex group count is 0, but the specified group index is 1


-- !query
select try(regexp_extract('1a 2b 14m', '\\d+', 1)) as try
-- !query schema
struct<try:string>
-- !query output
NULL


-- !query
select format_string('Hello %s %s', 'World') as notry
-- !query schema
struct<>
-- !query output
java.util.MissingFormatArgumentException
Format specifier '%s'


-- !query
select try(format_string('Hello %s %s', 'World')) as try
-- !query schema
struct<try:string>
-- !query output
NULL
