-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 2


-- !query 0
select v||'a', case v||'a' when 'aa' then 1 else 0 end, count(*) from (select unnest(array('a','b')) as v) u group by v||'a' order by 1
-- !query 0 schema
struct<concat(v, a):string,CASE WHEN (concat(v, a) = aa) THEN 1 ELSE 0 END:int,count(1):bigint>
-- !query 0 output
aa	1	1
ba	0	1


-- !query 1
select v||'a', case when v||'a' = 'aa' then 1 else 0 end, count(*) from (select unnest(array('a','b')) as v) u group by v||'a' order by 1
-- !query 1 schema
struct<concat(v, a):string,CASE WHEN (concat(v, a) = aa) THEN 1 ELSE 0 END:int,count(1):bigint>
-- !query 1 output
aa	1	1
ba	0	1
