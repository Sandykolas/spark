-- Automatically generated by SQLQueryTestSuite
-- Number of queries: 10


-- !query 0
select unnest(array(1,2))
-- !query 0 schema
struct<unnest:int>
-- !query 0 output
1
2


-- !query 1
select unnest(null)
-- !query 1 schema
struct<>
-- !query 1 output
org.apache.spark.sql.AnalysisException
cannot resolve 'unnest(NULL)' due to data type mismatch: input to function unnest should be array type not null; line 1 pos 7


-- !query 2
select unnest(array(null))
-- !query 2 schema
struct<unnest:null>
-- !query 2 output
NULL


-- !query 3
select unnest(a) from values (array(1, 2)), (array(3, 4)) as v1(a) where 1 = 0
-- !query 3 schema
struct<unnest:int>
-- !query 3 output



-- !query 4
select unnest(a) from values (array(1, 2)), (array(3, 4)) as v1(a)
-- !query 4 schema
struct<unnest:int>
-- !query 4 output
1
2
3
4


-- !query 5
select unnest(a) from values (array(1, 2)), (array(3, null)) as v1(a)
-- !query 5 schema
struct<unnest:int>
-- !query 5 output
1
2
3
NULL


-- !query 6
select unnest(a) from values (array(1, 2)), (array(3, array(5, 6))) as v1(a)
-- !query 6 schema
struct<>
-- !query 6 output
org.apache.spark.sql.AnalysisException
cannot resolve 'array(3, array(5, 6))' due to data type mismatch: input to function array should all be the same type, but it's [int, array<int>]; line 1 pos 45


-- !query 7
select unnest(array(1, 2, 1.0, '1'))
-- !query 7 schema
struct<unnest:string>
-- !query 7 output
1
1
1.0
2


-- !query 8
select unnest(a) from values (array(1, 2)), (array(3, 4)), (null) as v1(a)
-- !query 8 schema
struct<unnest:int>
-- !query 8 output
1
2
3
4


-- !query 9
select unnest(a) from values (array(1, 2)), (array(3, 4, 5)) as v1(a)
-- !query 9 schema
struct<unnest:int>
-- !query 9 output
1
2
3
4
5
